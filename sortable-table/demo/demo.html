<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SortableTable Demo</title>
    <link rel="stylesheet" href="/src/sortable-table.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f0f0f0;
            min-height: 100vh;
        }

        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin: 0;
        }

        .demo-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .demo-section h2 {
            color: #333;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .controls {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            font-size: 14px;
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn:hover {
            background: #cbd5e0;
            transform: translateY(-2px);
        }

        .table-container {
            height: 500px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #64748b;
            font-size: 0.9rem;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .feature-card h3 {
            margin-top: 0;
            color: #2d3748;
        }

        .feature-card ul {
            margin: 0;
            padding-left: 20px;
            color: #4a5568;
        }

        .code-example {
            background: #f0f0f0;
            color: darkslategrey;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            margin: 20px 0;
            overflow-x: auto;
            white-space: pre-wrap;
        }

        .highlight {
            color: #32ad61;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .demo-section {
                padding: 20px;
            }

            .controls {
                justify-content: center;
            }

            .table-container {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="header">
            <h1>SortableTable</h1>
            <p>A powerful, reusable, and configurable table component</p>
        </div>

        <!-- Main Demo -->
        <div class="demo-section">
            <h2>Interactive Demo</h2>
            <p>Click column headers to sort, use pagination controls, and click the page number to jump to a specific page.</p>

            <div class="controls">
                <button class="btn" onclick="addRandomEmployee()">Add Employee</button>
                <button class="btn" onclick="filterHighEarners()">Show High Earners</button>
                <button class="btn" onclick="filterByDepartment()">Filter Engineering</button>
                <button class="btn" onclick="clearAllFilters()">Clear Filters</button>

                <button class="btn" onclick="removeRandomEmployee()">Remove Random Employee</button>
                <button class="btn" onclick="removeInactiveEmployees()">Remove Inactive</button>
                <button class="btn" onclick="toggleHiddenColumns()">Toggle Email Column</button>
            </div>

            <div id="main-table" class="table-container"></div>

            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="total-employees">0</div>
                    <div class="stat-label">Total Employees</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avg-salary">$0</div>
                    <div class="stat-label">Average Salary</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-pages">0</div>
                    <div class="stat-label">Total Pages</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="current-page">1</div>
                    <div class="stat-label">Current Page</div>
                </div>
            </div>
        </div>

        <!-- Usage Example -->
        <div class="demo-section">
            <h2>Usage Example</h2>

            <div class="code-example">
<span class="highlight">// Define your columns</span>
const columns = [
    { key: 'name', label: 'Name', type: 'string' },
    { key: 'salary', label: 'Salary', type: 'number',
      formatter: (value) => `$${value.toLocaleString()}` },
    { key: 'startDate', label: 'Start Date', type: 'date' }
];

<span class="highlight">// Create the table</span>
const table = new SortableTable({
    container: '#my-table',
    data: employeeData,
    columns: columns,
    rowsPerPage: 25,
    onSort: (column, direction) => console.log(`Sorted by ${column}`),
    onPageChange: (page) => console.log(`Page ${page}`),
    onRowClick: (data) => console.log('Row clicked:', data)
});
            </div>
        </div>
    </div>

    <script src="/src/sortable-table.js"></script>
    <script>
        // Sample data for the demo
        const departments = ['Engineering', 'Marketing', 'Sales', 'HR', 'Finance', 'Operations', 'Design', 'Support'];
        const firstNames = ['Alice', 'Bob', 'Charlie', 'Diana', 'Eve', 'Frank', 'Grace', 'Henry', 'Ivy', 'Jack', 'Kate', 'Liam', 'Mia', 'Noah', 'Olivia', 'Paul', 'Quinn', 'Ruby', 'Sam', 'Tina'];
        const lastNames = ['Johnson', 'Smith', 'Brown', 'Davis', 'Miller', 'Wilson', 'Moore', 'Taylor', 'Anderson', 'Thomas', 'Jackson', 'White', 'Harris', 'Martin', 'Garcia', 'Rodriguez', 'Lewis', 'Lee', 'Walker', 'Hall'];
        const cities = ['New York', 'San Francisco', 'Chicago', 'Boston', 'Seattle', 'Austin', 'Denver', 'Miami', 'Portland', 'Atlanta'];

        function generateEmployeeData(count = 150) {
            return Array.from({ length: count }, (_, i) => {
                const name = `${firstNames[Math.floor(Math.random() * firstNames.length)]} ${lastNames[Math.floor(Math.random() * lastNames.length)]}`;
                return [
                    i + 1, // id
                    name, // name
                    departments[Math.floor(Math.random() * departments.length)], // department
                    Math.floor(Math.random() * 120000) + 40000, // salary
                    cities[Math.floor(Math.random() * cities.length)], // city
                    new Date(2018 + Math.floor(Math.random() * 6), Math.floor(Math.random() * 12), Math.floor(Math.random() * 28) + 1), // startDate
                    Math.random() > 0.1, // active
                    `${name.toLowerCase().replace(' ', '.')}@company.com` // email
                ];
            });
        }

        const columns = [
            { key: 'id', label: 'ID', type: 'number', width: '60px' },
            { key: 'name', label: 'Employee Name', type: 'string', width: '180px' },
            { key: 'department', label: 'Department', type: 'string', width: '120px' },
            {
                key: 'salary',
                label: 'Annual Salary',
                type: 'number',
                width: '130px',
                formatter: (value) => `$${value.toLocaleString()}`
            },
            { key: 'city', label: 'Location', type: 'string', width: '100px' },
            {
                key: 'startDate',
                label: 'Start Date',
                type: 'date',
                width: '110px',
                formatter: (value) => value.toLocaleDateString()
            },
            {
                key: 'active',
                label: 'Status',
                type: 'boolean',
                width: '80px',
                formatter: (value) => value ? '✅ Active' : '❌ Inactive'
            },
            {
                key: 'email',
                label: 'Email',
                type: 'string',
                width: '200px',
                hidden: true // Initially hidden
            }
        ];

        let mainTable;
        let originalData;

        // Initialize the demo
        document.addEventListener('DOMContentLoaded', () => {
            originalData = generateEmployeeData(150);
            initializeMainTable();
        });

        function initializeMainTable() {
            mainTable = new SortableTable({
                container: '#main-table',
                data: originalData,
                columns: columns,
                rowsPerPage: 20,
                sort: { key: 'startDate', ascending: false }, // Initially sort by start date (newest first)
                onSort: (column, ascending) => {
                    console.log(`Table sorted by ${column} in ${ascending ? 'ascending' : 'descending'} order`);
                },
                onPageChange: (page, totalPages) => {
                    updateStats();
                    console.log(`Navigated to page ${page} of ${totalPages}`);
                },
                onRowClick: (data, index) => {
                    alert(`Employee Details:\n\nID: ${data[0]}\nName: ${data[1]}\nDepartment: ${data[2]}\nSalary: $${data[3].toLocaleString()}\nCity: ${data[4]}\nStart Date: ${data[5].toLocaleDateString()}\nActive: ${data[6] ? 'Yes' : 'No'}\nEmail: ${data[7]}`);
                }
            });

            updateStats();
        }

        function updateStats() {
            const totalEmployees = mainTable.data.length;
            const avgSalary = totalEmployees > 0
                ? Math.round(mainTable.data.reduce((sum, emp) => sum + emp[3], 0) / totalEmployees) // salary is index 3
                : 0;

            document.getElementById('total-employees').textContent = totalEmployees;
            document.getElementById('avg-salary').textContent = `$${avgSalary.toLocaleString()}`;
            document.getElementById('total-pages').textContent = mainTable.totalPages;
            document.getElementById('current-page').textContent = mainTable.currentPage;
        }

        // Interactive functions
        function addRandomEmployee() {
            const newEmployee = generateEmployeeData(1)[0];
            newEmployee[0] = Math.max(...originalData.map(e => e[0])) + 1; // update id

            originalData.push(newEmployee);
            mainTable.addRow(newEmployee);
            updateStats();

            // Show notification
            showNotification(`Added ${newEmployee[1]} to ${newEmployee[2]}`); // name and department
        }

        function removeRandomEmployee() {
            if (mainTable.data.length > 0) {
                const randomIndex = Math.floor(Math.random() * mainTable.data.length);
                const employeeToRemove = mainTable.data[randomIndex];
                const employeeId = employeeToRemove[0]; // ID is index 0
                const employeeName = employeeToRemove[1]; // name is index 1

                // Use new removeRows API - much cleaner!
                const removed = mainTable.removeRows(row => row[0] === employeeId);

                // Also remove from our original data array for stats
                originalData = originalData.filter(e => e[0] !== employeeId);

                updateStats();

                if (removed > 0) {
                    showNotification(`Removed ${employeeName}`);
                }
            }
        }

        function removeInactiveEmployees() {
            // Remove all inactive employees (active is index 6)
            const removed = mainTable.removeRows(row => !row[6]);

            // Also remove from original data for stats
            originalData = originalData.filter(e => e[6]); // keep only active

            updateStats();

            showNotification(`Removed ${removed} inactive employee${removed !== 1 ? 's' : ''}`);
        }

        function toggleHiddenColumns() {
            // Toggle the hidden property of the email column
            const emailColumn = columns.find(col => col.key === 'email');
            emailColumn.hidden = !emailColumn.hidden;

            // Recreate the table with updated column visibility
            initializeMainTable();
            updateStats();

            const action = emailColumn.hidden ? 'Hidden' : 'Shown';
            showNotification(`${action} email column`);
        }

        function filterHighEarners() {
            mainTable.filter(employee => employee[3] >= 80000); // salary is index 3
            updateStats();
            showNotification('Showing only high earners (≥$80,000)');
        }

        function filterByDepartment() {
            mainTable.filter(employee => employee[2] === 'Engineering'); // department is index 2
            updateStats();
            showNotification('Showing only Engineering department');
        }

        function clearAllFilters() {
            mainTable.clearFilter();
            updateStats();
            showNotification('All filters cleared');
        }

        // Notification system
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 20px;
                background: #4299e1;
                color: white;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                z-index: 1000;
                font-weight: 500;
                transform: translateX(400px);
                transition: transform 0.3s ease;
            `;
            notification.textContent = message;

            document.body.appendChild(notification);

            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);

            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.transform = 'translateX(400px)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>
